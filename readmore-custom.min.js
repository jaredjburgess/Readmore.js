/*!
 * @preserve
 *
 * Readmore.js jQuery plugin
 * Original - Author: @jed_foster
 * Original - Project home: http://jedfoster.github.io/Readmore.js
 * Current - Author: @jaredjburgess
 * Current - Project home: https://github.com/jaredjburgess/Readmore.js
 * Licensed under the MIT license
 *
 * Debounce function from http://davidwalsh.name/javascript-debounce-function
 */
!function(e){"use strict";function t(e,t,a){var i;return function(){var n=this,o=arguments,r=function(){i=null,a||e.apply(n,o)},s=a&&!i;clearTimeout(i),i=setTimeout(r,t),s&&e.apply(n,o)}}function a(e){var t=++h;return String(null==e?"rmjs-":e)+t}function i(e){var t=e.clone().css({height:"auto",width:e.width(),maxHeight:"none",overflow:"hidden"}).insertAfter(e),a=t.outerHeight(),i=parseInt(t.css({maxHeight:""}).css("max-height").replace(/[^-\d\.]/g,""),10),n=e.data("defaultHeight");e.has("img")&&a<e.outerHeight()&&(a=e.outerHeight()+15),t.remove();var o=i||e.data("collapsedHeight")||n;e.data({expandedHeight:a,maxHeight:i,collapsedHeight:o}).css({maxHeight:"none"})}function n(e){if(!l[e.selector]){var t=" ";e.embedCSS&&""!==e.blockCSS&&(t+=e.selector+" + [data-readmore-toggle], "+e.selector+"[data-readmore]{"+e.blockCSS+"}"),t+=e.selector+"[data-readmore]{transition: height "+e.speed+"ms;overflow: hidden;}",function(e,t){var a=e.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(e.createTextNode(t)),e.getElementsByTagName("head")[0].appendChild(a)}(document,t),l[e.selector]=!0}}function o(t){var a=t[0];a.added.forEach(function(t){e(t).attr("disabled","true").delay(250).queue(function(){e(this).removeAttr("disabled"),e(this).dequeue()})})}function r(t,a){this.element=t,this.options=e.extend({},d,a),n(this.options),this._defaults=d,this._name=s,this.init(),window.addEventListener?(window.addEventListener("load",c),window.addEventListener("resize",c)):(window.attachEvent("load",c),window.attachEvent("resize",c))}var s="readmore",d={speed:200,collapsedHeight:200,heightMargin:16,moreLink:'<a href="#">Read More</a>',lessLink:'<a href="#">Close</a>',embedCSS:!0,blockCSS:"display: block; width: 100%;",startOpen:!1,disableAfterPress:!1,beforeToggle:function(){},afterToggle:function(){}},l={},h=0,c=t(function(){e("[data-readmore]").each(function(){var t=e(this),a="true"===t.attr("aria-expanded");i(t),t.css({height:t.data(a?"expandedHeight":"collapsedHeight")})})},100);r.prototype={init:function(){var t=this,n=e(this.element);n.data({defaultHeight:this.options.collapsedHeight,heightMargin:this.options.heightMargin}),i(n);var r=n.data("collapsedHeight"),s=n.data("heightMargin");if(n.outerHeight(!0)<=r+s)return!0;var d=n.attr("id")||a(),l=t.options.startOpen?t.options.lessLink:t.options.moreLink;if(n.attr({"data-readmore":"","aria-expanded":!1,id:d}),n.after(e(l).on("click",function(a){return"disabled"==e(this).attr("disabled")?!1:void t.toggle(this,n[0],a)}).attr({"data-readmore-toggle":"","aria-controls":d})),t.options.startOpen||n.css({height:r}),t.options.disableAfterPress){new MutationSummary({callback:o,queries:[{attribute:"data-readmore-toggle"}]})}},toggle:function(t,a,i){if("disabled"==e(t).attr("disabled"))return!1;i&&i.preventDefault(),t||(console.log("not trigger called"),t=e('[aria-controls="'+this.element.id+'"]')[0]),a||(a=this.element);var n=this,o=e(a),r="",s="",d=!1,l=o.data("collapsedHeight");o.height()<=l?(console.log("changing exapanded to true"),r=o.data("expandedHeight")+"px",s="lessLink",d=!0):(r=l,s="moreLink"),console.log("checking expanded"),console.log(d),n.options.beforeToggle(t,a,!d);var h="height "+n.options.speed+"ms";o.css("transition",h),o.css("height",r).delay(n.options.speed).queue(function(){n.options.afterToggle(t,a,d),o.dequeue}).attr("aria-expanded",d),e(t).replaceWith(e(n.options[s]).on("click",function(t){return"disabled"==e(this).attr("disabled")?!1:void n.toggle(this,a,t)}).attr({"data-readmore-toggle":"","aria-controls":o.attr("id")}))},destroy:function(){e(this.element).each(function(){var t=e(this);t.attr({"data-readmore":null,"aria-expanded":null}).css({maxHeight:"",height:""}).next("[data-readmore-toggle]").remove(),t.removeData()})}},e.fn.readmore=function(t){var a=arguments,i=this.selector;return t=t||{},"object"==typeof t?this.each(function(){if(e.data(this,"plugin_"+s)){var a=e.data(this,"plugin_"+s);a.destroy.apply(a)}t.selector=i,e.data(this,"plugin_"+s,new r(this,t))}):"string"==typeof t&&"_"!==t[0]&&"init"!==t?this.each(function(){var i=e.data(this,"plugin_"+s);i instanceof r&&"function"==typeof i[t]&&i[t].apply(i,Array.prototype.slice.call(a,1))}):void 0}}(jQuery);
